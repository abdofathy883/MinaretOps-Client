<section class="container mb-4">
  <div class="card">
    <div
      class="d-flex justify-content-between align-items-center mb-3 pt-3 px-4 flex-wrap"
    >
      <h2>تسجيل الحضور</h2>
      <p class="current-time">{{ currentTime | date : "medium" }}</p>
    </div>
    <div class="card-body">
            <button
        class="check-in-btn"
        (click)="onAttendanceAction()"
        [disabled]="isProcessing || (!canClockIn() && !canClockOut())"
        [class.terquiese]="canClockIn()"
        [class.lime]="canClockOut()"
      >
        @if (isProcessing) {
          <span>جاري التسجيل...</span>
        } @else {
          <i [class]="getButtonIcon()"></i>
          <span>{{ getButtonText() }}</span>
        }
      </button>
    </div>
  </div>
</section>

<section class="container mb-4">
  <div class="card pt-3 px-4">
    <h2>حالة الحضور اليوم</h2>
    @if (attendanceErrorMessage) {
      <div class="alert alert-danger">
        {{ attendanceErrorMessage }}
      </div>
    }
    
    @if (todayRecord) {
      <div class="status-info">
        <p>
          <strong>وقت التسجيل:</strong>
          {{ todayRecord.clockIn | date : "shortTime" }}
        </p>
        @if (todayRecord.clockOut) {
          <p>
            <strong>وقت الانصراف:</strong>
            {{ todayRecord.clockOut | date : "shortTime" }}
          </p>
        }
        <p>
          <strong class="ms-3">الحالة:</strong>
          <span class="status-badge status-present">
            {{ getAttendanceStatusLabel(todayRecord.status) }}
          </span>
        </p>
        @if (todayRecord.clockIn && todayRecord.clockOut) {
          <p>
            <strong>مدة العمل:</strong>
            {{ calculateWorkDuration(todayRecord.clockIn, todayRecord.clockOut) }}
          </p>
        }
      </div>
    } @else {
      <div class="alert alert-info">
        لم يتم تسجيل الحضور اليوم بعد
      </div>
    }
  </div>
</section>

<!-- Alert Messages -->
@if (alertMessage) {
<div class="alert" [class]="'alert-' + alertType">
  {{ alertMessage }}
</div>
}
